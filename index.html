<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moonlight Cravings | Premium Bakery</title>

    <meta property="og:title" content="Moonlight Cravings | Premium Bakery">
    <meta property="og:description" content="Premium treats for every occasion. ðŸŒ™">
    <meta property="og:image" content="https://i.postimg.cc/1X6FLsmV/614595661_1819368908769275_8442615453582945422_n.png">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="icon" href="https://i.postimg.cc/vxYDnR6G/icon.png">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        :root { 
            --black: #0a0a0a;
            --dark-grey: #1a1a1a;
            --venom-white: #f5f5f5;
            --accent-silver: #c0c0c0;
            --pure-white: #ffffff;
        }
        
        body { 
            margin: 0; 
            font-family: 'Georgia', serif; 
            background: var(--black); 
            color: var(--venom-white); 
            -webkit-user-select: none; 
            user-select: none; 
            overflow-x: hidden; 
            position: relative; 
            min-height: 100vh;
            transition: all 0.5s ease;
        }

        /* Venom-like background elements */
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%); }
        
        nav { background: rgba(0, 0, 0, 0.95); padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; z-index:100; border-bottom: 1px solid #333; color: var(--venom-white); }
        .logo-container { display: flex; align-items: center; gap: 10px; }
        .logo { font-size: 1.2rem; font-weight: bold; color: var(--pure-white); letter-spacing: 2px; text-transform: uppercase; }
        
        /* Secret Button Style */
        .secret-btn { background: var(--pure-white); color: var(--black); border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 0.7rem; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; transition: 0.3s; box-shadow: 0 0 10px rgba(255,255,255,0.2); }
        .secret-btn:hover { background: #000; color: #fff; box-shadow: 0 0 20px rgba(255,255,255,0.5); border: 1px solid #fff; }

        .voucher-btn-nav { background: transparent; color: var(--accent-silver); border: 1px solid var(--accent-silver); padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; transition: 0.3s; }
        .voucher-btn-nav:hover { background: var(--venom-white); color: var(--black); }
        
        .wallet-pill { background: #1a1a1a; border: 1px solid #333; color: var(--pure-white); padding: 8px 18px; border-radius: 4px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .active-v-btn { background: var(--venom-white); color: var(--black); border: none; padding: 5px 10px; border-radius: 4px; font-size: 0.6rem; cursor: pointer; font-weight: bold; margin-left: 5px; }
        
        .hero-desc { text-align: center; padding: 40px 20px; color: white; text-shadow: 0 0 10px rgba(255,255,255,0.3); line-height: 1.6; }
        .container { max-width: 1200px; margin: auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; padding: 20px; }
        
        /* Card Noir Style */
        .card { background: #111; border: 1px solid #222; border-radius: 0; overflow: hidden; text-align: center; padding-bottom: 20px; transition: 0.4s; color: var(--venom-white); }
        .card:hover { border-color: #fff; transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .card img { width: 100%; height: 200px; object-fit: cover; filter: grayscale(40%); transition: 0.5s; }
        .card:hover img { filter: grayscale(0%); }
        
        select, textarea, input[type="text"], .cart-select { background: #000; color: #fff; border: 1px solid #333; width: 85%; padding: 10px; margin: 8px 0; outline: none; }
        
        .btn { background: var(--pure-white); color: var(--black); border: none; padding: 12px 25px; cursor: pointer; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; transition: 0.3s; }
        .btn:hover:not(:disabled) { background: #888; color: #fff; }

        /* Resolution Selection Modal */
        #resolution-popup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 20000; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }

        /* Secret Overlay */
        #secret-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: #000; z-index: 10000; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; }

        #chat-window { display: none; position: fixed; bottom: 90px; right: 20px; width: 340px; height: 550px; background: #0a0a0a; border: 1px solid #333; box-shadow: 0 15px 50px rgba(0,0,0,0.9); z-index: 3000; flex-direction: column; overflow: hidden; color: #fff; }
        .chat-header { background: #1a1a1a; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        #order-success-modal, #claim-popup, #confirm-popup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #000; width: 320px; z-index: 5000; text-align: center; box-shadow: 0 0 30px rgba(255,255,255,0.1); padding: 25px; border: 1px solid #fff; color: #fff; }
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:4999; backdrop-filter: blur(8px); }
        
        #voucher-overlay, #active-vouchers-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: #000; z-index: 11000; flex-direction: column; justify-content: center; align-items: center; color: #fff; text-align: center; }
        .voucher-card { background: #111; border: 1px solid #333; padding: 40px; max-width: 400px; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="resolution-popup">
    <h1 style="letter-spacing: 5px;">MOONLIGHT CRAVINGS</h1>
    <p style="opacity: 0.6;">SELECT YOUR EXPERIENCE</p>
    <div style="display: flex; gap: 20px; margin-top: 20px;">
        <button class="btn" onclick="setResolution('mobile')">MOBILE / TABLET</button>
        <button class="btn" onclick="setResolution('pc')">PC / 4K DESKTOP</button>
    </div>
</div>

<div class="bg-animation" id="bg-elements"></div>
<div class="overlay" id="modal-overlay"></div>

<div id="secret-overlay">
    <h1 style="font-size: 3rem; margin: 10px 0; letter-spacing: 10px;">THE VAULT</h1>
    <p style="font-size: 1.2rem; font-style: italic; color: #888;">"Where whispers turn to reality. Whatever Secrets Said Here, Gets Chosen."</p>
    <div style="margin-top: 30px; width: 80%; max-width: 500px;">
        <textarea id="secret-input" placeholder="Speak your secret desire or code..." style="height: 100px; width: 100%;"></textarea>
        <button class="btn" style="width: 100%; margin-top: 10px;" onclick="processSecret()">SUBMIT TO DARKNESS</button>
    </div>
    <p onclick="closeSecret()" style="margin-top: 25px; cursor: pointer; font-size: 0.8rem; text-decoration: underline; color: #555;">RETURN TO LIGHT</p>
</div>

<div id="confirm-popup">
    <h3 id="confirm-title">Use Voucher?</h3>
    <p id="confirm-msg">Apply this dark reward to your cart.</p>
    <div style="display:flex; gap:10px; justify-content:center;">
        <button class="btn" onclick="executeVoucherUse()">CONFIRM</button>
        <button class="btn" onclick="closeConfirm()" style="background:#333; color:#fff;">CANCEL</button>
    </div>
</div>

<div id="voucher-overlay">
    <div class="voucher-card">
        <h1 class="logo">Vouchers</h1>
        <div style="border-top: 1px solid #333; margin-top: 20px; padding-top: 20px;">
            <input type="text" id="v-code" placeholder="Enter Code">
            <button class="btn" onclick="redeemVoucher()" style="width: 100%;">REDEEM</button>
        </div>
        <p onclick="closeVoucher()" style="margin-top: 25px; cursor: pointer; font-size: 0.8rem;">Close</p>
    </div>
</div>

<div id="active-vouchers-overlay">
    <div class="voucher-card" style="width: 90%; max-width: 450px;">
        <h2>Active Vouchers</h2>
        <div id="active-v-list" style="max-height: 300px; overflow-y: auto; margin: 20px 0;"></div>
        <button class="btn" onclick="closeActiveVouchers()" style="background:none; border: 1px solid #fff; color:#fff;">Close</button>
    </div>
</div>

<nav>
    <div class="logo-container">
        <div class="logo">MOONLIGHT CRAVINGS</div>
        <button class="secret-btn" onclick="openSecret()">Secret?</button>
        <button class="voucher-btn-nav" onclick="openVoucher()">Vouchers</button>
    </div>
    <div style="display:flex; gap:10px; align-items:center;">
        <div class="wallet-pill">MP <span id="user-points">0</span><button class="active-v-btn" onclick="openActiveVouchers()">ACTIVE</button></div>
        <div onclick="openCart()" style="cursor:pointer; font-size:1.5rem">ðŸ›’<span id="cart-count" style="font-size:0.8rem; background:white; color:black; padding:2px 6px; border-radius:50%">0</span></div>
    </div>
</nav>

<div class="hero-desc">
    <h2 style="font-size: 2.5rem; letter-spacing: 2px;">Premium Noir Bakery</h2>
    <p>Handcrafted treats with zero preservatives. Freshly baked, darkly delicious.</p>
</div>

<div class="container" id="main-container">
    <div class="card">
        <img id="cake-img" src="https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400">
        <div class="card-body">
            <h3>Premium Cakes</h3>
            <select id="cake-select" onchange="checkFunfetti(this)">
                <optgroup label="Standard">
                    <option value="500" data-label="0.5kg Lemon Cake">Lemon: 0.5kg - â‚¹500</option>
                    <option value="999" data-label="1kg Lemon Cake">Lemon: 1kg - â‚¹999</option>
                    <option value="500" data-label="0.5kg Chocolate Cake">Chocolate: 0.5kg - â‚¹500</option>
                    <option value="999" data-label="1kg Chocolate Cake">Chocolate: 1kg - â‚¹999</option>
                    <option value="500" data-label="0.5kg Vanilla Cake">Vanilla: 0.5kg - â‚¹500</option>
                    <option value="999" data-label="1kg Vanilla Cake">Vanilla: 1kg - â‚¹999</option>
                    <option value="500" data-label="0.5kg Black Forest Cake">Black Forest: 0.5kg - â‚¹500</option>
                    <option value="999" data-label="1kg Black Forest Cake">Black Forest: 1kg - â‚¹999</option>
                </optgroup>
                <optgroup label="Banana"><option value="350" data-label="0.5kg Banana Cake">0.5kg - â‚¹350</option></optgroup>
            </select>
            <button class="btn" onclick="addToCartBySelect('cake-select')">Add to Cart</button>
        </div>
    </div>
    
    <div class="card">
        <img id="cupcake-img" src="https://images.unsplash.com/photo-1519869325930-281384150729?w=400">
        <div class="card-body">
            <h3>Cupcakes (Box of 5)</h3>
            <select id="cupcake-select" onchange="updateImage(this, 'cupcake-img')">
                <option value="200" data-label="5x Vanilla Cupcakes">Vanilla - â‚¹200</option>
                <option value="200" data-label="5x Chocolate Cupcakes">Chocolate - â‚¹200</option>
                <option value="275" data-label="5x Blueberry Cupcakes">Blueberry - â‚¹275</option>
            </select>
            <button class="btn" onclick="addToCartBySelect('cupcake-select')">Add to Cart</button>
        </div>
    </div>

    <div class="card">
        <img id="snack-img" src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400">
        <div class="card-body">
            <h3>Bakery Snacks</h3>
            <select id="snack-select" onchange="updateImage(this, 'snack-img')">
                <option value="180" data-label="10pc Donut Holes">Donut Holes (10pcs) - â‚¹180</option>
                <option value="150" data-label="6pc Churros">Churros (6pcs) - â‚¹150</option>
                <option value="240" data-label="6pc Brownies">Brownies (6pcs) - â‚¹240</option>
            </select>
            <button class="btn" onclick="addToCartBySelect('snack-select')">Add to Cart</button>
        </div>
    </div>

    <div class="card" style="display:flex; flex-direction:column; justify-content:center; padding: 20px;">
        <h3>Custom Requests</h3>
        <textarea id="custom-req" placeholder="Specific flavors or large orders..."></textarea>
        <button class="btn" onclick="addCustomToCart()">Submit Request</button>
    </div>
</div>

<div id="chat-window">
    <div class="chat-header"><h4>Your Cart</h4><button onclick="toggleChatWindow()" style="border:none; background:none; color:white; cursor:pointer;">âœ•</button></div>
    <div style="padding:20px; flex:1; overflow-y:auto;">
        <div id="cart-items"></div><hr><div id="voucher-applied-area"></div>
        <div style="font-weight:bold; margin:10px 0;">Total: â‚¹<span id="cart-total-val">0</span></div>
        <input type="text" id="c-name" placeholder="Name">
        <input type="text" id="c-phone" placeholder="WhatsApp">
        <select id="c-method" class="cart-select" style="width: 100%;" onchange="toggleAddressField()"><option value="Delivery">Delivery</option><option value="Pickup">Pickup</option></select>
        <div id="address-container"><input type="text" id="c-addr" placeholder="Address"></div>
        <button class="btn" style="width:100%; margin-top:15px;" onclick="submitOrder()">Place Order</button>
    </div>
</div>

<div id="order-success-modal">
    <h2>Order Placed!</h2>
    <p>Confirmation via <b>+91 8870459614</b> soon.</p>
    <button id="success-close-btn" class="btn" onclick="closeSuccessAndRefresh()">I UNDERSTAND</button>
</div>

<button onclick="toggleChatWindow()" style="position:fixed; bottom:20px; right:20px; background:white; color:black; border:none; width:60px; height:60px; border-radius:50%; font-size:25px; cursor:pointer; z-index:2000;">ðŸ’¬</button>

<script>
    const firebaseConfig = { apiKey: "AIzaSyBLvz14iffabRCLRc3FuDvqhCvN5qs3a84", authDomain: "moonlight-cravings.firebaseapp.com", projectId: "moonlight-cravings", storageBucket: "moonlight-cravings.firebasestorage.app", messagingSenderId: "222974574228", appId: "1:222974574228:web:47bed645deedf5788bbe81" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let userIP = ""; let myCart = []; let _SECURE_POINTS = 0; let myVouchers = []; let activeVoucherId = null; let pendingVoucherToUse = null;

    const GLOBAL_CODES = { "SECRET100": { type: "discount", value: 100, desc: "GOD MODE: 100% OFF" } };

    window.onload = async function() {
        const r = await fetch('https://api.ipify.org?format=json'); 
        const d = await r.json(); userIP = d.ip;
        db.collection("users").doc(userIP).onSnapshot(doc => { if(doc.exists) { const data = doc.data(); _SECURE_POINTS = data.points || 0; myVouchers = data.claimedVouchers || []; document.getElementById('user-points').innerText = _SECURE_POINTS; } });
    };

    function setResolution(type) {
        const container = document.getElementById('main-container');
        if(type === 'mobile') {
            // Detect Apple vs Samsung (generic Android)
            const isApple = /iPhone|iPad|iPod/i.test(navigator.userAgent);
            container.style.gridTemplateColumns = "1fr";
            container.style.padding = "10px";
            // Custom scaling for mobile
            document.body.style.fontSize = "14px";
            alert(isApple ? "Optimized for Apple Device" : "Optimized for Samsung/Android Device");
        } else {
            container.style.gridTemplateColumns = "repeat(auto-fit, minmax(350px, 1fr))";
        }
        document.getElementById('resolution-popup').style.display = 'none';
    }

    function openSecret() { document.getElementById('secret-overlay').style.display = 'flex'; }
    function closeSecret() { document.getElementById('secret-overlay').style.display = 'none'; }
    function processSecret() {
        const input = document.getElementById('secret-input').value;
        if(input.toUpperCase() === "VENOM") {
            alert("The Symbiote has chosen you. 50% discount voucher added.");
            // Logic to add special voucher
        } else {
            alert("The darkness remains silent...");
        }
        document.getElementById('secret-input').value = "";
    }

    // Logic Functions (Kept as requested)
    function openVoucher() { document.getElementById('voucher-overlay').style.display = 'flex'; }
    function closeVoucher() { document.getElementById('voucher-overlay').style.display = 'none'; }
    function openActiveVouchers() { renderActiveVouchers(); document.getElementById('active-vouchers-overlay').style.display = 'flex'; }
    function closeActiveVouchers() { document.getElementById('active-vouchers-overlay').style.display = 'none'; }
    async function redeemVoucher() {
        const code = document.getElementById('v-code').value; 
        if(!GLOBAL_CODES[code]) return alert("Invalid Code!");
        const voucherData = { code: code, ...GLOBAL_CODES[code], used: false }; myVouchers.push(voucherData);
        await db.collection("users").doc(userIP).set({ claimedVouchers: myVouchers }, { merge: true }); alert("Unlocked!"); closeVoucher();
    }
    function renderActiveVouchers() {
        const list = document.getElementById('active-v-list'); if(myVouchers.filter(v => !v.used).length === 0) { list.innerHTML = "<p>Empty...</p>"; return; }
        list.innerHTML = myVouchers.filter(v => !v.used).map((v, i) => `<div style="padding:10px; border:1px solid #333; margin:5px;"><b>${v.value}</b><br><button class="btn" style="padding:5px; font-size:0.6rem;" onclick="askToUseVoucher('${v.code}')">Apply</button></div>`).join('');
    }
    function askToUseVoucher(code) { pendingVoucherToUse = code; document.getElementById('confirm-popup').style.display = 'block'; }
    function closeConfirm() { document.getElementById('confirm-popup').style.display = 'none'; }
    function executeVoucherUse() { activeVoucherId = pendingVoucherToUse; renderCart(); closeConfirm(); closeActiveVouchers(); }
    function renderCart() {
        document.getElementById('cart-count').innerText = myCart.length; let total = 0;
        document.getElementById('cart-items').innerHTML = myCart.map((item, i) => { total += item.price; return `<div style="display:flex; justify-content:space-between; margin:5px 0;"><span>${item.name}</span><span>â‚¹${item.price}</span></div>`; }).join('');
        document.getElementById('cart-total-val').innerText = total;
    }
    function addToCartBySelect(id) { const el = document.getElementById(id); myCart.push({ name: el.options[el.selectedIndex].getAttribute('data-label'), price: parseInt(el.value) }); renderCart(); }
    function toggleChatWindow() { const w = document.getElementById('chat-window'); w.style.display = w.style.display === 'flex' ? 'none' : 'flex'; }
    function openCart() { toggleChatWindow(); }
    function toggleAddressField() { document.getElementById('address-container').style.display = (document.getElementById('c-method').value === 'Pickup') ? 'none' : 'block'; }
    function closeSuccessAndRefresh() { location.reload(); }
</script>
</body>
</html>
