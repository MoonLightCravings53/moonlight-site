<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoonlightCravings | Premium Bakery</title>

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <meta property="og:title" content="MoonlightCravings | Premium Bakery">
    <meta property="og:description" content="üåô Premium treats for every occasion. üåô">
    <meta property="og:image" content="https://i.postimg.cc/1X6FLsmV/614595661_1819368908769275_8442615453582945422_n.png">
    <meta property="og:type" content="website">

    <link rel="icon" href="https://i.postimg.cc/vxYDnR6G/icon.png">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    
    <style>
        :root { 
            --black: #050505;
            --dark-grey: #121212;
            --venom-white: #ffffff;
        }
        
        body { 
            margin: 0; font-family: 'Georgia', serif; 
            background: var(--black); color: var(--venom-white); 
            -webkit-user-select: none; user-select: none; 
            overflow-x: hidden; position: relative; min-height: 100vh;
        }

        /* --- AUTH MODAL STYLES --- */
        #auth-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 60000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .auth-box {
            background: #0a0a0a; border: 2px solid white; padding: 40px;
            width: 320px; text-align: center;
        }

        #device-detector { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; z-index: 40000; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border: 5px solid white; }
        #rotate-prompt { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 50000; flex-direction: column; justify-content: center; align-items: center; text-align: center; color: white; padding: 20px; }
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; }
        .floating-item { position: absolute; font-size: 2rem; opacity: 0.1; animation: moveAcross 15s linear infinite; color: white; }
        @keyframes moveAcross { from { transform: translate(-100px, -100px) rotate(0deg); } to { transform: translate(110vw, 110vh) rotate(360deg); } }
        
        nav { background: rgba(0, 0, 0, 0.95); padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; z-index:100; border-bottom: 2px solid white; }
        .logo { font-size: 1.1rem; font-weight: bold; letter-spacing: 3px; text-transform: uppercase; color: white; }
        .secret-btn { background: white; color: black; border: 2px solid white; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 0 15px rgba(255,255,255,0.4); transition: 0.3s; }
        .wallet-pill { background: #111; border: 1px solid white; color: white; padding: 8px 18px; border-radius: 4px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .hero-desc { text-align: center; padding: 40px 20px; color: white; }
        .hero-desc h2 { font-size: 2.5rem; letter-spacing: 5px; margin: 0; text-transform: uppercase; }
        
        .container { max-width: 1200px; margin: auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; padding: 20px; }
        .card { background: #0a0a0a; border: 1px solid #333; border-radius: 0px; overflow: hidden; text-align: center; padding-bottom: 25px; transition: 0.4s; color: white; }
        .card:hover { border-color: white; transform: translateY(-10px); }
        .card img { width: 100%; height: 230px; object-fit: cover; filter: grayscale(100%); transition: 0.5s; }
        .card:hover img { filter: grayscale(0%); }
        .btn { background: white; color: black; border: none; padding: 12px 25px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        
        select, textarea, input { background: #111; color: white; border: 1px solid #444; padding: 10px; margin: 8px 0; width: 85%; outline: none; }
        #chat-window { display: none; position: fixed; bottom: 20px; right: 20px; width: 340px; height: 85vh; background: white; border-radius: 10px; z-index: 3000; flex-direction: column; overflow: hidden; color: black; border: 3px solid black; }
        #secret-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: black; z-index: 20000; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        #order-success-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #000; border: 2px solid white; color: white; padding: 30px; z-index: 10000; width: 300px; text-align: center; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="auth-overlay">
    <div class="auth-box">
        <h2 style="letter-spacing: 5px; margin-bottom: 25px;">MOONLIGHT ACCESS</h2>
        
     <div id="g_id_onload"
     data-client_id="222974574228-dbf0nq3fu2ijdo2l9j68e012fddf0pe1.apps.googleusercontent.com"
     data-context="signin"
     data-ux_mode="popup"
     data-callback="handleCredentialResponse"
     data-auto_prompt="false">
</div>

        <div class="g_id_signin"
             data-type="standard"
             data-shape="rectangular"
             data-theme="outline"
             data-text="signin_with"
             data-size="large"
             data-logo_alignment="left">
        </div>
        
        <p style="font-size: 0.7rem; color: #555; margin-top: 20px;">Secure Access via Google Identity</p>
    </div>
</div>

<div id="device-detector" style="display:none;">
    <h1 style="letter-spacing: 10px;">SYSTEM START</h1>
    <p>PICK YOUR INTERFACE</p>
    <div style="display: flex; gap: 20px; margin-top: 20px;">
        <button class="btn" onclick="setResolution('mobile')">MOBILE</button>
        <button class="btn" onclick="setResolution('pc')">COMPUTER</button>
    </div>
</div>

<div id="rotate-prompt">
    <h1 style="font-size: 3.5rem;">üîÑ</h1>
    <h2>PLEASE ROTATE HORIZONTAL</h2>
    <p>Turn your phone sideways to view the full bakery menu.</p>
    <button class="btn" style="margin-top: 20px;" onclick="closeRotatePrompt()">I AM ROTATED</button>
</div>

<div class="bg-animation" id="bg-elements"></div>

<nav>
    <div style="display:flex; align-items:center; gap:15px;">
        <div class="logo">MOONLIGHTCRAVINGS</div>
        <button class="secret-btn" onclick="openSecret()">SECRET?</button>
    </div>
    <div style="display:flex; gap:10px; align-items:center;">
        <button class="btn" style="padding: 5px 10px; font-size: 0.7rem;" onclick="handleLogout()">LOGOUT</button>
        <div class="wallet-pill">MP <span id="user-points">0</span></div>
        <div onclick="openCart()" style="cursor:pointer; font-size:1.5rem">üõí<span id="cart-count" style="background:white; color:black; padding:2px 6px; border-radius:50%; font-size:0.8rem">0</span></div>
    </div>
</nav>

<div class="hero-desc">
    <h2>PREMIUM CRAVINGS.</h2>
    <p>NO PRESERVATIVES. DARK ELEGANCE.</p>
</div>

<div class="container">
    <div class="card">
        <img id="cake-img" src="https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400">
        <h3>Premium Cakes</h3>
        <select id="cake-select" onchange="checkFunfetti(this)">
            <optgroup label="Standard">
                <option value="500" data-label="0.5kg Lemon Cake">Lemon: 0.5kg - ‚Çπ500</option>
                <option value="999" data-label="1kg Lemon Cake">Lemon: 1kg - ‚Çπ999</option>
                <option value="500" data-label="0.5kg Chocolate Cake">Chocolate: 0.5kg - ‚Çπ500</option>
                <option value="500" data-label="0.5kg Vanilla Cake">Vanilla: 0.5kg - ‚Çπ500</option>
                <option value="500" data-label="0.5kg Black Forest Cake">Black Forest: 0.5kg - ‚Çπ500</option>
                <option value="500" data-label="0.5kg Funfetti Cake">Funfetti: 0.5kg - ‚Çπ500</option>
            </optgroup>
            <optgroup label="Special">
                <option value="600" data-label="0.5kg Dark Chocolate Cake">Dark Chocolate: 0.5kg - ‚Çπ600</option>
                <option value="600" data-label="0.5kg Orange Cake">Orange: 0.5kg - ‚Çπ600</option>
                <option value="350" data-label="0.5kg Banana Cake">Banana Cake: 0.5kg - ‚Çπ350</option>
            </optgroup>
        </select>
        <button class="btn" onclick="addToCartBySelect('cake-select')">Add to Cart</button>
    </div>

    <div class="card">
        <img id="cupcake-img" src="https://images.unsplash.com/photo-1519869325930-281384150729?w=400">
        <h3>Cupcakes (Box of 5)</h3>
        <select id="cupcake-select" onchange="updateImage(this, 'cupcake-img')">
            <option value="200" data-label="5x Vanilla Cupcakes">Vanilla - ‚Çπ200</option>
            <option value="200" data-label="5x Chocolate Cupcakes">Chocolate - ‚Çπ200</option>
            <option value="200" data-label="5x Lemon Cupcakes">Lemon - ‚Çπ200</option>
            <option value="275" data-label="5x Blueberry Cupcakes">Blueberry - ‚Çπ275</option>
        </select>
        <button class="btn" onclick="addToCartBySelect('cupcake-select')">Add to Cart</button>
    </div>

    <div class="card" style="display:flex; flex-direction:column; justify-content:center; padding: 20px;">
        <h3>‚ú® Custom Requests</h3>
        <textarea id="custom-req" placeholder="Describe your dream treat..."></textarea>
        <button class="btn" onclick="addCustomToCart()">Add Custom Order</button>
    </div>
</div>

<div id="chat-window">
    <div style="background:#000; color:white; padding:15px; display:flex; justify-content:space-between;"><h4>üõí YOUR CART</h4><button onclick="toggleChatWindow()" style="background:none; color:white; border:none; cursor:pointer;">‚úï</button></div>
    <div style="padding:20px; overflow-y:auto; flex:1;">
        <div id="cart-items"></div><hr>
        <div style="font-weight:bold; margin:10px 0; font-size:1.2rem;">Total: ‚Çπ<span id="cart-total-val">0</span></div>
        <input type="text" id="c-name" placeholder="Full Name">
        <input type="text" id="c-phone" placeholder="WhatsApp Number">
        <select id="c-method" style="width:100%"><option value="Delivery">üöÄ Delivery</option><option value="Pickup">üè™ Pickup</option></select>
        <input type="text" id="c-addr" placeholder="Address">
        <button class="btn" style="width:100%; margin-top:10px; background:black; color:white; border:2px solid black;" onclick="submitOrder()">Place Order</button>
    </div>
</div>

<div id="order-success-modal">
    <h2>ORDER PLACED</h2>
    <p>Check WhatsApp for confirmation.</p>
    <p style="font-size:0.8rem;">Processing in: <span id="timer-sec">10</span>s</p>
    <button id="success-close-btn" class="btn" disabled onclick="location.reload()">OK</button>
</div>

<div id="secret-overlay">
    <h1 style="font-size: 3rem;">WHISPER INTO THE VOID</h1>
    <input type="text" placeholder="..." style="background:transparent; border-bottom: 2px solid white; width: 60%; text-align: center; font-size: 1.5rem; margin: 30px;">
    <button class="btn" onclick="closeSecret()">RETURN</button>
</div>

<script>
    const firebaseConfig = { apiKey: "AIzaSyBLvz14iffabRCLRc3FuDvqhCvN5qs3a84", authDomain: "moonlight-cravings.firebaseapp.com", projectId: "moonlight-cravings", storageBucket: "moonlight-cravings.firebasestorage.app", messagingSenderId: "222974574228", appId: "1:222974574228:web:47bed645deedf5788bbe81" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    
    let userIP = ""; let myCart = []; let _SECURE_POINTS = 0;

    // --- GOOGLE AUTH LOGIC ---
    function handleCredentialResponse(response) {
        const credential = firebase.auth.GoogleAuthProvider.credential(response.credential);
        auth.signInWithCredential(credential).catch(e => alert(e.message));
    }

    auth.onAuthStateChanged(user => {
        if(user) {
            document.getElementById('auth-overlay').style.display = 'none';
            document.getElementById('device-detector').style.display = 'flex';
            loadUserData(user.email);
        } else {
            document.getElementById('auth-overlay').style.display = 'flex';
        }
    });

    function handleLogout() { auth.signOut().then(() => location.reload()); }

    // --- SHOP LOGIC ---
    window.onload = async function() {
        const r = await fetch('https://api.ipify.org?format=json');
        const d = await r.json(); userIP = d.ip;
        createFloatingBackground();
    };

    function loadUserData(email) {
        db.collection("users").doc(email).onSnapshot(doc => { 
            if(doc.exists) { 
                _SECURE_POINTS = doc.data().points || 0; 
                document.getElementById('user-points').innerText = _SECURE_POINTS; 
            } 
        });
    }

    function setResolution(type) {
        document.getElementById('device-detector').style.display = 'none';
        if(type === 'mobile') { document.getElementById('rotate-prompt').style.display = 'flex'; }
    }
    function closeRotatePrompt() { document.getElementById('rotate-prompt').style.display = 'none'; }

    function createFloatingBackground() { 
        const bg = document.getElementById('bg-elements');
        for(let i=0; i<15; i++) { 
            const span = document.createElement('span'); span.className = 'floating-item'; span.innerText = '‚ö´'; 
            span.style.left = Math.random() * 100 + 'vw'; span.style.top = Math.random() * 100 + 'vh'; bg.appendChild(span);
        } 
    }

    function addToCartBySelect(id) { 
        const el = document.getElementById(id); const label = el.options[el.selectedIndex].getAttribute('data-label');
        myCart.push({ name: label, price: parseInt(el.value) }); renderCart();
    }

    function addCustomToCart() { 
        const req = document.getElementById('custom-req').value; if(!req) return alert("What are your requirements?");
        myCart.push({ name: "CUSTOM: " + req, price: 0 }); renderCart(); document.getElementById('custom-req').value = "";
    }

    function renderCart() {
        document.getElementById('cart-count').innerText = myCart.length;
        let t = 0; document.getElementById('cart-items').innerHTML = myCart.map((item, i) => { t += item.price; return `<div style="display:flex; justify-content:space-between; margin-bottom:5px;"><span>${item.name}</span><span>‚Çπ${item.price}</span></div>`; }).join('');
        document.getElementById('cart-total-val').innerText = t;
    }

    async function submitOrder() {
        const n = document.getElementById('c-name').value; const p = document.getElementById('c-phone').value;
        if(!n || !p || myCart.length === 0) return alert("Fill all details!");
        await db.collection("orders").add({ 
            user: auth.currentUser.email,
            name: n, phone: p, items: myCart.map(i => i.name).join(", "), 
            price: document.getElementById('cart-total-val').innerText, 
            customerIP: userIP, timestamp: firebase.firestore.FieldValue.serverTimestamp() 
        });
        startSuccessCountdown();
    }

    function startSuccessCountdown() {
        document.getElementById('order-success-modal').style.display = 'block';
        let tl = 10; const itv = setInterval(() => { tl--; document.getElementById('timer-sec').innerText = tl; if(tl<=0){ clearInterval(itv); document.getElementById('success-close-btn').disabled = false; } }, 1000);
    }

    function checkFunfetti(el) {
        const label = el.options[el.selectedIndex].getAttribute('data-label');
        const map = { "Black Forest": "https://i.postimg.cc/W3PvhrFk/Black-forest.png", "Dark Chocolate": "https://i.postimg.cc/hvCJQTkL/Dark-Chocolate-Cake.png", "Orange": "https://i.postimg.cc/L6gN0F0F/Orange-cake.jpg", "Funfetti": "https://i.postimg.cc/R0GsjwSn/Fun-fetty.jpg", "Vanilla": "https://i.postimg.cc/mDJBBq3g/Vanilla-Cake.png", "Lemon": "https://i.postimg.cc/hvmgjrMs/Lemon-cake.png", "Banana": "https://i.postimg.cc/xdj0RLTT/Bannana-Cake.png" };
        for (let k in map) { if(label.includes(k)) { document.getElementById('cake-img').src = map[k]; return; } }
    }

    function updateImage(sel, id) {
        const label = sel.options[sel.selectedIndex].getAttribute('data-label');
        const map = { "Donut": "https://i.postimg.cc/pXjYMKVW/Donut-holes.jpg", "Brownies": "https://i.postimg.cc/jqmQ1Mb8/brownies.jpg", "Churros": "https://i.postimg.cc/Qx7kZc8R/Churros.jpg", "Butter": "https://i.postimg.cc/k4Fd84Ky/butter-cookies.jpg", "Choco chip": "https://i.postimg.cc/NFHCTC3y/Chocolate-chip-cookies.jpg", "Sugar": "https://i.postimg.cc/J4jdzg3p/Sugar-cookies.jpg", "Macarons": "https://i.postimg.cc/yY7rWjfx/Macarons.jpg" };
        for (let k in map) { if(label.includes(k)) { document.getElementById(id).src = map[k]; return; } }
    }

    function toggleChatWindow() { const w = document.getElementById('chat-window'); w.style.display = w.style.display === 'flex' ? 'none' : 'flex'; }
    function openCart() { toggleChatWindow(); }
    function openSecret() { document.getElementById('secret-overlay').style.display = 'flex'; }
    function closeSecret() { document.getElementById('secret-overlay').style.display = 'none'; }
</script>
</body>
</html>


