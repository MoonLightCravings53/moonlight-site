<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoonlightCravings | Premium Bakery</title>

    <meta property="og:title" content="MoonlightCravings | Premium Bakery">
    <meta property="og:description" content="ðŸŒ™ Premium treats for every occasion. ðŸŒ™">
    <meta property="og:image" content="https://i.postimg.cc/1X6FLsmV/614595661_1819368908769275_8442615453582945422_n.png">
    
    <link rel="icon" href="https://i.postimg.cc/vxYDnR6G/icon.png">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <style>
        :root { 
            --black: #050505;
            --white: #ffffff;
            --grey: #1a1a1a;
        }
        
        body { 
            margin: 0; font-family: 'Georgia', serif; 
            background: var(--black); color: var(--white); 
            -webkit-user-select: none; user-select: none; 
            overflow-x: hidden; min-height: 100vh;
        }

        /* Responsive Grid: 1 column on mobile, 2 on tablets, 3+ on desktop */
        .container { 
            max-width: 1200px; margin: auto; display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; padding: 20px;
        }

        /* Device Detectors */
        #device-detector, #rotate-prompt {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 50000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; border: 5px solid white; box-sizing: border-box;
        }

        #rotate-prompt { display: none; background: rgba(0,0,0,0.95); }

        /* Navigation */
        nav { 
            background: rgba(0, 0, 0, 0.95); padding: 15px;
            display: flex; justify-content: space-between; align-items: center; 
            position: sticky; top:0; z-index:100; border-bottom: 2px solid white;
        }
        .logo { font-size: 1rem; font-weight: bold; letter-spacing: 2px; text-transform: uppercase; }

        /* Product Cards */
        .card { 
            background: #0a0a0a; border: 1px solid #333; 
            text-align: center; padding-bottom: 20px; transition: 0.3s;
        }
        .card:hover { border-color: white; }
        .card img { width: 100%; height: 200px; object-fit: cover; filter: grayscale(100%); transition: 0.5s; }
        .card:hover img { filter: grayscale(0%); }

        /* Inputs & Buttons */
        .btn { background: white; color: black; border: none; padding: 12px 20px; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .btn:hover { background: #bbb; }
        select, textarea, input { background: #111; color: white; border: 1px solid #444; padding: 10px; margin: 5px 0; width: 90%; }

        /* Cart Window - Responsive Width */
        #chat-window { 
            display: none; position: fixed; bottom: 20px; right: 20px; 
            width: 350px; max-width: 90vw; height: 80vh; 
            background: white; color: black; z-index: 4000;
            flex-direction: column; border: 3px solid black; border-radius: 10px;
        }

        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        .floating-item { position: absolute; font-size: 1.5rem; opacity: 0.1; animation: move 20s linear infinite; }
        @keyframes move { from { transform: translate(-10vw, -10vh); } to { transform: translate(110vw, 110vh); } }
    </style>
</head>
<body>

<div id="device-detector">
    <h1>SYSTEM START</h1>
    <p>SELECT YOUR DEVICE</p>
    <button class="btn" onclick="handleDevice('mobile')">MOBILE</button>
    <button class="btn" onclick="handleDevice('pc')">COMPUTER</button>
</div>

<div id="rotate-prompt">
    <h1>ðŸ”„</h1>
    <h2>PLEASE ROTATE HORIZONTAL</h2>
    <p>We recommend landscape mode for the best ordering experience.</p>
    <button class="btn" onclick="closeRotate()">I'M READY</button>
</div>

<div class="bg-animation" id="bg-elements"></div>

<nav>
    <div class="logo">MOONLIGHTCRAVINGS</div>
    <div style="display:flex; gap:15px; align-items:center;">
        <div style="border:1px solid white; padding:5px 10px;">MP: <span id="user-points">0</span></div>
        <div onclick="toggleCart()" style="cursor:pointer; font-size:1.2rem;">ðŸ›’ <span id="cart-count">0</span></div>
    </div>
</nav>

<div class="container">
    <div class="card">
        <img id="cake-img" src="https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400">
        <h3>Premium Cakes</h3>
        <select id="cake-select" onchange="updateCakeImg(this)">
            <option value="500" data-label="0.5kg Lemon Cake">Lemon (0.5kg) - â‚¹500</option>
            <option value="999" data-label="1kg Lemon Cake">Lemon (1kg) - â‚¹999</option>
            <option value="500" data-label="0.5kg Chocolate Cake">Chocolate (0.5kg) - â‚¹500</option>
            <option value="500" data-label="0.5kg Black Forest">Black Forest - â‚¹500</option>
            <option value="500" data-label="0.5kg Funfetti">Funfetti - â‚¹500</option>
        </select>
        <button class="btn" onclick="addToCart('cake-select')">Add to Cart</button>
    </div>

    <div class="card">
        <img src="https://images.unsplash.com/photo-1519869325930-281384150729?w=400">
        <h3>Cupcakes (Box of 5)</h3>
        <select id="cupcake-select">
            <option value="200" data-label="5x Vanilla Cupcakes">Vanilla - â‚¹200</option>
            <option value="200" data-label="5x Chocolate Cupcakes">Chocolate - â‚¹200</option>
            <option value="275" data-label="5x Blueberry Cupcakes">Blueberry - â‚¹275</option>
        </select>
        <button class="btn" onclick="addToCart('cupcake-select')">Add to Cart</button>
    </div>

    <div class="card">
        <img src="https://images.unsplash.com/photo-1499636136210-6f4ee915583e?w=400">
        <h3>Cookie Boxes</h3>
        <select id="cookie-select">
            <option value="200" data-label="8x Butter Cookies">Butter Cookies - â‚¹200</option>
            <option value="240" data-label="8x Choco-chip">Choco-chip - â‚¹240</option>
        </select>
        <button class="btn" onclick="addToCart('cookie-select')">Add to Cart</button>
    </div>

    <div class="card">
        <img src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400">
        <h3>Bakery Snacks</h3>
        <select id="snack-select">
            <option value="180" data-label="10pc Donut Holes">Donut Holes - â‚¹180</option>
            <option value="240" data-label="6pc Brownies">Brownies - â‚¹240</option>
        </select>
        <button class="btn" onclick="addToCart('snack-select')">Add to Cart</button>
    </div>

    <div class="card" style="padding: 20px;">
        <h3>âœ¨ Custom Orders</h3>
        <textarea id="custom-req" placeholder="Describe your custom cake or bulk order details..."></textarea>
        <button class="btn" onclick="addCustom()">Add Custom to Cart</button>
    </div>
</div>

<div id="chat-window">
    <div style="background:black; color:white; padding:15px; display:flex; justify-content:space-between;">
        <span>YOUR CART</span>
        <button onclick="toggleCart()" style="color:white; background:none; border:none;">âœ•</button>
    </div>
    <div style="padding:15px; overflow-y:auto; flex:1;" id="cart-list"></div>
    <div style="padding:15px; border-top:1px solid #ddd;">
        <div style="font-weight:bold; margin-bottom:10px;">Total: â‚¹<span id="cart-total">0</span></div>
        <input type="text" id="c-name" placeholder="Name">
        <input type="text" id="c-phone" placeholder="WhatsApp Number">
        <input type="text" id="c-addr" placeholder="Delivery Address">
        <button class="btn" style="width:100%; background:black; color:white;" onclick="placeOrder()">Submit Order</button>
    </div>
</div>

<script>
    // Firebase Init
    const firebaseConfig = { apiKey: "AIzaSyBLvz14iffabRCLRc3FuDvqhCvN5qs3a84", projectId: "moonlight-cravings" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let cart = [];
    let userIP = "Guest";

    function handleDevice(type) {
        document.getElementById('device-detector').style.display = 'none';
        if(type === 'mobile') document.getElementById('rotate-prompt').style.display = 'flex';
    }

    function closeRotate() { document.getElementById('rotate-prompt').style.display = 'none'; }

    function addToCart(id) {
        const el = document.getElementById(id);
        const item = {
            name: el.options[el.selectedIndex].getAttribute('data-label'),
            price: parseInt(el.value)
        };
        cart.push(item);
        updateCartUI();
    }

    function addCustom() {
        const val = document.getElementById('custom-req').value;
        if(!val) return alert("Please enter details");
        cart.push({ name: "CUSTOM: " + val, price: 0 });
        document.getElementById('custom-req').value = "";
        updateCartUI();
    }

    function updateCartUI() {
        document.getElementById('cart-count').innerText = cart.length;
        let total = 0;
        const html = cart.map(item => {
            total += item.price;
            return `<div style="display:flex; justify-content:space-between; font-size:0.9rem; margin-bottom:5px;">
                        <span>${item.name}</span><span>â‚¹${item.price}</span>
                    </div>`;
        }).join('');
        document.getElementById('cart-list').innerHTML = html;
        document.getElementById('cart-total').innerText = total;
    }

    function toggleCart() {
        const win = document.getElementById('chat-window');
        win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
    }

    async function placeOrder() {
        const name = document.getElementById('c-name').value;
        const phone = document.getElementById('c-phone').value;
        if(!name || !phone || cart.length === 0) return alert("Missing details or empty cart");

        await db.collection("orders").add({
            name, phone, 
            items: cart.map(i => i.name).join(", "),
            total: document.getElementById('cart-total').innerText,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        alert("Order Placed! Check WhatsApp for confirmation.");
        location.reload();
    }

    function updateCakeImg(el) {
        const label = el.options[el.selectedIndex].getAttribute('data-label');
        const img = document.getElementById('cake-img');
        if(label.includes("Lemon")) img.src = "https://i.postimg.cc/hvmgjrMs/Lemon-cake.png";
        if(label.includes("Black Forest")) img.src = "https://i.postimg.cc/W3PvhrFk/Black-forest.png";
        if(label.includes("Funfetti")) img.src = "https://i.postimg.cc/R0GsjwSn/Fun-fetty.jpg";
    }

    // BG Animation
    const bg = document.getElementById('bg-elements');
    for(let i=0; i<15; i++) {
        const s = document.createElement('span'); s.className = 'floating-item'; s.innerText = 'ðŸŒ™';
        s.style.left = Math.random() * 100 + 'vw'; s.style.top = Math.random() * 100 + 'vh';
        bg.appendChild(s);
    }
</script>
</body>
</html>
