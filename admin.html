<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Moonlight Vault | Owner Control</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        body { background: #fce4ec; font-family: 'Segoe UI', sans-serif; padding: 40px; color: #4a148c; }
        .header { text-align: center; margin-bottom: 50px; }
        .header h1 { color: #b76e79; font-size: 2.5rem; letter-spacing: 3px; }
        
        #orders-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 25px; max-width: 1400px; margin: auto; }
        
        .order-card { background: white; border-radius: 25px; padding: 30px; position: relative; box-shadow: 0 10px 20px rgba(0,0,0,0.03); border-top: 8px solid #b76e79; transition: 0.3s; }
        .order-card:hover { transform: scale(1.02); }
        
        .status-pill { position: absolute; top: 20px; right: 20px; background: #fff1f5; color: #b76e79; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        
        .data-row { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #fff1f5; }
        .label { display: block; font-size: 0.7rem; color: #b76e79; text-transform: uppercase; font-weight: bold; margin-bottom: 3px; }
        .value { font-size: 1rem; color: #4a148c; }
        
        .btn-call { display: block; width: 100%; padding: 12px; background: #2ecc71; color: white; text-align: center; text-decoration: none; border-radius: 15px; font-weight: bold; margin-top: 15px; }
        
        /* Stats Bar */
        .stats { display: flex; justify-content: center; gap: 20px; margin-bottom: 40px; }
        .stat-box { background: white; padding: 20px 40px; border-radius: 20px; text-align: center; }
    </style>
</head>
<body>

    <div class="header">
        <h1>MOONLIGHT VAULT üåô</h1>
        <p>Live Cloud Order Stream</p>
    </div>

    <div id="orders-grid">
        <p style="text-align:center; grid-column: 1/-1;">Connecting to Moonlight Cloud...</p>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBLvz14iffabRCLRc3FuDvqhCvN5qs3a84",
            authDomain: "moonlight-cravings.firebaseapp.com",
            projectId: "moonlight-cravings",
            storageBucket: "moonlight-cravings.firebasestorage.app",
            messagingSenderId: "222974574228",
            appId: "1:222974574228:web:47bed645deedf5788bbe81",
            measurementId: "G-MGJQD332QD"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Real-time listener
        db.collection("orders").orderBy("timestamp", "desc").onSnapshot(snapshot => {
            const grid = document.getElementById('orders-grid');
            if(snapshot.empty) {
                grid.innerHTML = "<p style='text-align:center; grid-column:1/-1;'>No orders in the vault yet.</p>";
                return;
            }

            grid.innerHTML = snapshot.docs.map(doc => {
                const o = doc.data();
                const time = o.timestamp ? o.timestamp.toDate().toLocaleString('en-IN') : "New Order";
                
                return `
                    <div class="order-card">
                        <div class="status-pill">NEW ORDER</div>
                        
                        <div class="data-row">
                            <span class="label">Cake / Request</span>
                            <div class="value" style="font-weight:bold; font-size:1.2rem;">${o.item}</div>
                        </div>

                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                            <div class="data-row">
                                <span class="label">Customer</span>
                                <div class="value">${o.name}</div>
                            </div>
                            <div class="data-row">
                                <span class="label">Gmail</span>
                                <div class="value">${o.email || 'None'}</div>
                            </div>
                        </div>

                        <div class="data-row">
                            <span class="label">Phone Number</span>
                            <div class="value">+91 ${o.phone}</div>
                        </div>

                        <div class="data-row">
                            <span class="label">üìç Delivery Address</span>
                            <div class="value" style="font-size: 0.9rem;">${o.address}</div>
                        </div>

                        <div class="data-row">
                            <span class="label">Ordered At</span>
                            <div class="value" style="font-size: 0.8rem; opacity:0.7;">${time}</div>
                        </div>

                        <a href="tel:${o.phone}" class="btn-call">üìû CALL CUSTOMER</a>
                    </div>
                `;
            }).join('');
        });
    </script>
</body>
</html>
